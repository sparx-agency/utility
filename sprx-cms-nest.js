function fetchWithTimeout(t,e={},r=5e3){let n=new AbortController,o=n.signal,a=setTimeout(()=>n.abort(),r);return fetch(t,{...e,signal:o}).then(t=>(clearTimeout(a),t)).catch(t=>{if(clearTimeout(a),"AbortError"===t.name)throw Error("Request timed out");throw t})}function cmsNest(){let t=[];document.querySelectorAll("[data-cms-nest^='item']").forEach(e=>{let r=e.querySelector("[data-cms-nest='link']");if(!r){console.warn("CMS Nest: Link not found",e);return}let n=r.getAttribute("href");if(!n){console.warn("CMS Nest: Href attribute not found",r);return}try{let o=new URL(n,window.location.origin);if(o.hostname!==window.location.hostname){console.warn("CMS Nest: URL is not on the same domain",o);return}let a=e.querySelectorAll("[data-cms-nest^='dropzone-']");if(0===a.length)return;let s=fetchWithTimeout(n).then(t=>{if(!t.ok)throw Error(`HTTP error! Status: ${t.status}`);return t.text()}).then(t=>{let e=new DOMParser().parseFromString(t,"text/html");a.forEach(t=>{let r=t.getAttribute("data-cms-nest").split("-")[1],n=e.querySelector(`[data-cms-nest='target-${r}']`);n?t.replaceChildren(n):console.warn(`CMS Nest: Target-${r} not found in fetched content`,o)})}).catch(t=>{console.error("CMS Nest: Error fetching the link or request timed out:",t)});t.push(s)}catch(i){console.error("CMS Nest: Invalid URL",n,i)}}),Promise.all(t).then(()=>{let t=new CustomEvent("cmsNestComplete");window.dispatchEvent(t)}).catch(t=>{console.error("CMS Nest: One or more fetch requests failed",t)})}document.addEventListener("DOMContentLoaded",cmsNest);
